{% extends "base.html" %}

{% block content %}


<link rel="stylesheet" type="text/css" href="../static/css/player_profile.css" charset="utf-8" />

<h1 style="text-transform: none"> {{ (user.outfit + " | ") if user.outfit else "" }} {{ user.callsign }}</h1>


<div class="playerInfo">

<img class="playerImage" src="{{ url_for('registration.serve_image', id=user.image.id) }}" onerror="this.onerror=null; this.src='../static/img/soldierC.jpg'"/>


<p id="player_name"> {{ user.lastname }}, {{ user.firstname }} </p>
<p> Career highlights: </p>

{% if uid %}
<p>
    Assigned to operations @ {{ uid.field.replace('_',' ') or '_ _ _ _ _'}}. <br/>
    <br/>
    Objectives held by team: <br/>

    {% if team %}
        {% for node in team.nodes if (node.config == 10 and node.location) %}
        {{ node.location }} <br/>
        {% endfor %} <br/>
    {% endif %}

    {{ 'Discharged from' if uid.medic.alive else 'Checked into'}} the infirmary on {{ uid.medic.timestamp.strftime(' %d %b %Y @ %H%M hours') }}. <br/>
    You are {{ 'FFD' if uid.medic.alive else 'NPQ' }}.
</p>
{% endif %}

{% set cap = user.captures or 0 %}
{% set ass = user.assists or 0 %}
{% set pts = (cap * 2) + ass %}

{% set rad = 50 %}
{% set circ = rad * 2 * 3.14159 %}

{% set perc_cap = cap*2/(pts or 1) %}
{% set perc_ass = ass/(pts or 1) %}
{% set perc_pts = pts  %}

{% set stroke_w = rad / 4 %}

<div class="playerStats">

    <p style="margin: 1em 0 0 0">Battlefield contributions:</p>

  <table id="table">

    <thead>
        <tr>
            <th class="header">Captures</td>
            <th class="header">Capture Assists</td>
            <th class="header">Total Points</td>
        </tr>
    </thead>

    <tbody>

      <tr>

        <td>
            <svg width="100%">
              <circle class="capture" cx="50%" cy="50%" r="{{ rad }}">
                  <set attributeName='stroke-width' to="{{ stroke_w }}"/>
                  <set attributeName='stroke' from="#808080" to="#C0C0C0" begin="mouseover" end="mouseout"/>
                  <set attributeName='stroke-dashoffset' to="{{ -(circ - circ * perc_cap) }}"/>
                  <set attributeName='stroke-dasharray' to="{{ circ }} {{ circ }}"/>
              </circle>
              <text x="50%" y="52.5%" text-anchor="middle">{{ cap }}</text>
            </svg>
        </td>

        <td>
            <svg width="100%">
              <circle class="assist" cx="50%" cy="50%" r="{{ rad }}">
                  <set attributeName='stroke-width' to="{{ stroke_w }}"/>
                  <set attributeName='stroke' from="#800000" to="#F0C0C0" begin="mouseover" end="mouseout"/>
                  <set attributeName='stroke-dashoffset' to="{{ circ - circ * perc_ass }}"/>
                  <set attributeName='stroke-dasharray' to="{{ circ }} {{ circ }}"/>
              </circle>
              <text x="50%" y="52.5%" text-anchor="middle">{{ ass }}</text>
            </svg>
        </td>

        <td>
            <svg width="100%" >
              <circle class="capture" cx="50%" cy="50%" r="{{ rad }}">
                  <set attributeName='stroke-width' to="{{ stroke_w }}"/>
                  <set attributeName='stroke' from="#808080" to="#C0C0C0" begin="mouseover" end="mouseout"/>
                  <set attributeName='stroke-dashoffset' to="{{ -(circ - circ * perc_cap) }}"/>
                  <set attributeName='stroke-dasharray' to="{{ circ }} {{ circ }}"/>
              </circle>
              <circle class="assist" cx="50%" cy="50%" r="{{ rad }}">
                  <set attributeName='stroke-width' to="{{ stroke_w }}"/>
                  <set attributeName='stroke' from="#800000" to="#F0C0C0" begin="mouseover" end="mouseout"/>
                  <set attributeName='stroke-dashoffset' to="{{ circ - circ * perc_ass }}"/>
                  <set attributeName='stroke-dasharray' to="{{ circ }} {{ circ }}"/>
              </circle>
              <text x="50%" y="52.5%" text-anchor="middle">{{ pts }}</text>
            </svg>
        </td>

      </tr>

    </tbody>

  </table>

</div>

</div>

<br/><br/>

<ul class="nav" style="font-size: 80%">
    <li><a href="/register"> Update profile </a></li>
    <li><a href="/update_password"> Change Password </a></li>
    <li><a href="/update_callsign"> Change Callsign </a></li>
    <li><a href="/logout">Logout</a></li>
</ul>


{% endblock %}
