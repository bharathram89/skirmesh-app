{% extends "base.html" %}

{% block content %}

<link rel="stylesheet" type="text/css" href="../static/css/node_admin.css" charset="utf-8" />



<body>

    <ul class="nav">
    <li {{ "style=display:none" if not cmd_dict }}>
    <input class="button"
           id="end_game_button"
           type="button"
           name="action"
           {% if is_paused %}
              value="Resume Game"
           {% else %}
              value="Pause Game"
           {% endif %}
           onclick="form_submit(this)">
       </input></li>

   <li {{ "style=display:none" if not cmd_dict }}>
   <input class="button"
          id="start_game_button"
          type="button"
          name="action"
          value="Start Game"
          onclick="form_submit(this)">
      </input></li>

    <li {{ "style=display:none" if cmd_dict }}>
    <input class="button"
           id="discover_network_button"
           type="button"
           name="action"
           value="Discover Network"
           onclick="form_submit(this)">
       </input></li>
    </ul>



    {% if cmd_dict %}

        <label style="float: right;"><input type="checkbox" id="do_broadcast" onclick="enable_broadcast(this)" /> BROADCAST (UPDATE ALL) </label>
        <label style="float: left;"> Field:  {{ field.replace('_',' ').upper() }} </label>

        <div class="node_table">

          <table>

            <thead>
              <tr>

                  <th class="header"> node id </th>
                  <th class="header"> location </th>
                  <th class="header"> config </th>
                  <th class="header"> team </th>
                  <th class="header broadcast"> capture<br/>time </th>
                  <th class="header broadcast"> capture<br/>assist </th>
                  <th class="header "> point<br/>scale </th>
                  <th class="header broadcast"> medic<br/>time </th>
                  <th class="header broadcast"> medic </th>
                  <th class="header broadcast"> Bomb<br/>FUS &nbsp;&nbsp;|&nbsp;&nbsp; ARM &nbsp;&nbsp;|&nbsp;&nbsp; DIS </th>

              </tr>
            </thead>

            <tbody>

                {% for node in node_status %}
                <tr class="row" id="{{ node.node | safe }}">

                    <td disabled > {{ node.node[12:14] | safe }} {{ node.node[14:] | safe }} </td>
                    <td>

                        <select class="FF" onchange="update_controller(this)" onblur="update_location_tree({{ cmd_args['SET LOCATION'] }})">

                          <option/>
                          {% for opt in cmd_args['SET LOCATION'] %}
                            <option {{ 'selected' if opt['text'] == node.location }}>{{ opt['text'] }}</option>
                          {% endfor %}

                        </select>

                    </td>

                    <td ondblclick="unlock(this)">

                        <select class="00" disabled onchange="update_config(this)" onblur="this.disabled = true">

                        {% for key in cmd_dict %}
                          <option value="{{ '%02X' % key }}" {{ 'selected' if key == node.config }}>
                            {{ cmd_dict[key] }}
                          </option>
                        {% endfor %}

                        </select>

                    </td>

                    <td ondblclick="unlock(this)">

                        <select class="04" disabled onchange="update_team(this)" onblur="this.disabled = true">

                            <option value=""/>
                            {% for team in team_name %}
                              <option value="{{ team }}" {{ 'selected' if team == node.team }}>
                                {{ team_name[team] }}
                              </option>
                            {% endfor %}


                        </select>

                    </td>

                    <td>

                        <select class="8A" onchange="update_param(this)">

                            {% for opt in cmd_args['TIME DATA'] %}
                            <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.cap_time }}>
                              {{ print_time( (opt['value'] | int(opt['value'],16)) * 10 ) }}
                            </option>
                            {% endfor %}

                        </select>

                    </td>

                    <td>

                        <select class="8C" onchange="update_param(this)">

                            {% for opt in cmd_args['SET ASSIST %'] %}
                              <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.cap_asst }}>
                                {{ opt['text'] }}
                              </option>
                            {% endfor %}

                        </select>

                    </td>

                    <td>

                        <select class="9A" onchange="update_controller(this)">

                            {% for opt in cmd_args['SET POINT SCALE'] %}
                              <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.point_scale }}>
                                {{ opt['text'] }}
                              </option>
                            {% endfor %}

                        </select>

                    </td>

                    <td>

                        <select class="8E" onchange="update_controller(this)">

                            {% for opt in cmd_args['TIME DATA'] %}
                            <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.med_time }}>
                              {{ print_time( (opt['value'] | int(opt['value'],16)) * 10 ) }}
                            </option>
                            {% endfor %}

                        </select>

                    </td>

                    <td>

                        <select class="9B" onchange="update_controller(this)">

                            {% for opt in cmd_args['ALLOW MEDIC'] %}
                            <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.allow_medic }}>
                              {{ opt['text'] }}
                            </option>
                            {% endfor %}

                        </select>

                    </td>

                    <td nowrap {% if node.bomb_status == 186 %} style="background-color: #CC550080" {% endif %}>

                        <select class="8B" onchange="update_param(this)" style="width: 30%">

                            {% for opt in cmd_args['TIME DATA'] %}
                            <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.bomb_time }}>
                              {{ print_time( (opt['value'] | int(opt['value'],16)) * 10 ) }}
                            </option>
                            {% endfor %}

                        </select> |

                        <select class="8F" onchange="update_param(this)" style="width: 30%">

                            {% for opt in cmd_args['TIME DATA'] %}
                            <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.arm_time }}>
                              {{ print_time( (opt['value'] | int(opt['value'],16)) * 10 ) }}
                            </option>
                            {% endfor %}

                        </select> |

                        <select class="8D" onchange="update_param(this)" style="width: 30%">

                            {% for opt in cmd_args['TIME DATA'] %}
                            <option value="{{ opt['value'] }}" {{ 'selected' if (opt['value'] | int(opt['value'],16)) == node.diff_time }}>
                              {{ print_time( (opt['value'] | int(opt['value'],16)) * 10 ) }}
                            </option>
                            {% endfor %}

                        </select>

                    </td>

                </tr>
                {% endfor %}

            </tbody>

          </table>

        </div>

    {% endif %}

</body>

<script src="../static/js/node_admin.js"></script>
<script> update_location_tree({{ cmd_args['SET LOCATION'] | safe }});</script>

{% endblock %}
